package com.foozup.update.dao;

import java.util.ArrayList;
import java.util.List;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.jdbc.core.namedparam.MapSqlParameterSource;
import org.springframework.jdbc.core.namedparam.NamedParameterJdbcTemplate;

import com.foozup.common.Utils;
import com.foozup.dao.AbstractDao;
import com.foozup.update.dao.rowMapper.UpdateBaseFranchiseRowMapper;
import com.foozup.update.dao.rowMapper.UpdateBaseRestRowMapper;
import com.foozup.updates.model.UpdateBase;
import com.foozup.updates.model.dto.UpdateFranchiseDto;
import com.foozup.updates.model.dto.UpdateRestDto;

public class UpdatesDaoImpl implements IUpdatesDao {

	private AbstractDao abstractDao;
	private static final Logger logger = LoggerFactory.getLogger(UpdatesDaoImpl.class);;

	public UpdatesDaoImpl(AbstractDao abstractDao) {
		this.abstractDao = abstractDao;
	}

	@Override
	public List<UpdateFranchiseDto> getRestAsFrachiseUpdate(Integer restId) {
		List<UpdateFranchiseDto> updateBaseList = new ArrayList<>();
		try {
			MapSqlParameterSource parameters = new MapSqlParameterSource();
			parameters.addValue("restId", restId);
			parameters.addValue("startDate", Utils.getTodayStartDateTime());
			parameters.addValue("endDate", Utils.getTodayEndDateTime());
			parameters.addValue("restEndTime", Utils.getCurrentTimeAsString());
			parameters.addValue("restEndTime2", Utils.getCurrentTimeAsString());
			parameters.addValue("franchiseEndTime", Utils.getCurrentTimeAsString());

			String query = "select franchisee_updates.id as update_id,restaurants.id as rest_id, case when restaurants.end_time_2 is null OR restaurants.end_time_2 ='' then  restaurants.end_time "
					+ "else restaurants.end_time_2 end as rest_end_time,franchisee_updates.end_time as update_end_time,"
					+ " (Select group_concat(days separator ', ') from franchisee_updates_days where franchisee_updates_days.update_id = franchisee_updates.id group "
					+ "by franchisee_updates_days.update_id) as days, "
					+ " franchisee_updates.all_time as all_time,  franchisee_updates.updates as update_text, "
					+ "franchisee_updates.start_date as update_start_date, franchisee_updates.end_date as update_end_time from restaurants left join franchisee_updates_restaurant on "
					+ "franchisee_updates_restaurant.restaurant_id = restaurants.id left join franchisee_updates on "
					+ "franchisee_updates.id = franchisee_updates_restaurant.update_id where restaurants.id = "+restId +" and  "
					+ "franchisee_updates.status = 1 and franchisee_updates.start_date <= \""+Utils.getTodayStartDateTime()+"\" and franchisee_updates.end_date >= \""+Utils.getTodayEndDateTime()+"\" and "
					+ "((franchisee_updates.all_time = 1 and (time_format(str_to_date(restaurants.end_time, \"%h:%i %p\"), \"%H:%i:%s\") >= \""+Utils.getCurrentTimeAsString()+"\" or "
					+ "time_format(str_to_date(restaurants.end_time_2, \"%h:%i %p\"), \"%H:%i:%s\") >= \""+Utils.getCurrentTimeAsString()+"\")) or "
					+ "(franchb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            isee_updates.all_time = 0 and franchisee_updates.end_time >= \""+Utils.getCurrentTimeAsString()+"\"))";

/*			String query = "select franchisee_updates.id as update_id,restaurants.id as rest_id, case when restaurants.end_time_2 is null OR restaurants.end_time_2 ='' then  restaurants.end_time "
					+ "else restaurants.end_time_2 end as rest_end_time,franchisee_updates.end_time as update_end_time,"
					+ " (Select group_concat(days separator ', ') from franchisee_updates_days where franchisee_updates_days.update_id = franchisee_updates.id group "
					+ "by franchisee_updates_days.update_id) as days, "
					+ " franchisee_updates.all_time as all_time,  franchisee_updates.updates as update_text, "
					+ "franchisee_updates.start_date as update_start_date, franchisee_updates.end_date as update_end_time from restaurants left join franchisee_updates_restaurant on "
					+ "franchisee_updates_restaurant.restaurant_id = restaurants.id left join franchisee_updates on "
					+ "franchisee_updates.id = franchisee_updates_restaurant.update_id where restaurants.id = :restId and  "
					+ "franchisee_updates.status = 1 and franchisee_updates.start_date <= \":startDate\" and franchisee_updates.end_date >= \":endDate\" and "
					+ "((franchisee_updates.all_time = 1 and (time_format(str_to_date(restaurants.end_time, \"%h:%i %p\"), \"%H:%i:%s\") >= \":restEndTime\" or "
					+ "time_format(str_to_date(restaurants.end_time_2, \"%h:%i %p\"), \"%H:%i:%s\") >= \":restEndTime2\")) or "
					+ "(franchb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            isee_updates.all_time = 0 and franchisee_updates.end_time >= \":franchiseEndTime\"))";
*/
			/*NamedParameterJdbcTemplate template = new NamedParameterJdbcTemplate(
					abstractDao.getJdbcTemplate().getDataSource());
			updateBaseList = template.query(query, parameters, new UpdateBaseFranchiseRowMapper());
*/
			updateBaseList = abstractDao.getJdbcTemplate().query(query,
			        new UpdateBaseFranchiseRowMapper());
		} catch (Exception ex) {
			logger.error("Error in  findRestrauantByLocation :" + ex.getMessage());
		}
		return updateBaseList;

	}
	@Override
	public List<UpdateRestDto> getRestUpdate(Integer restId) {
		List<UpdateRestDto> updateBaseList = new ArrayList<>();
		try {
			MapSqlParameterSource parameters = new MapSqlParameterSource();
			parameters.addValue("restId", restId);
			parameters.addValue("startDate", Utils.getTodayStartDateTime());
			parameters.addValue("endDate", Utils.getTodayEndDateTime());
			parameters.addValue("restEndTime", Utils.getCurrentTimeAsString());
			parameters.addValue("restEndTime2", Utils.getCurrentTimeAsString());
			parameters.addValue("updateEndTime", Utils.getCurrentTimeAsString());

			String query = "select  restaurant_updates.id as update_id,restaurants.id as rest_id, (Select group_concat(days separator ', ') "
					+ "from restaurant_updates_days where restaurant_updates_days.update_id = restaurant_updates.id group by restaurant_updates_days.update_id) "
					+ "as active_days, case when restaurants.start_time_2 is null OR restaurants.start_time_2 ='' then  restaurants.start_time else "
					+ "restaurants.start_time_2 end as rest_start_time,case when restaurants.end_time_2 is null OR restaurants.end_time_2 ='' then "
					+ "restaurants.end_time else restaurants.end_time_2 end as rest_end_time, restaurant_updates.start_time as update_start_time, "
					+ "restaurant_updates.end_time as update_end_time, restaurant_updates.all_time, restaurant_updates.updates as update_text, "
					+ "restaurant_updates.is_primary as is_primary ,restaurant_updates.start_date as update_start_date, restaurant_updates.end_date as update_end_date"
					+ " from restaurants left join restaurant_updates on restaurant_updates.restaurant_id = "
					+ "restaurants.id where restaurants.id = "+restId+" and restaurant_updates.status = 1 and "
					+ "restaurant_updates.start_date <= \""+Utils.getTodayStartDateTime()+"\" and restaurant_updates.end_date >= \""+Utils.getTodayEndDateTime()+"\" and ((restaurant_updates.all_time = 1 and "
					+ "(time_format(str_to_date(restaurants.end_time, \"%h:%i %p\"), \"%H:%i:%s\")>= \""+Utils.getCurrentTimeAsString()+"\" or "
					+ "time_format(str_to_date(restaurants.end_time_2,\"%h:%i %p\"), \"%H:%i:%s\") >= \""+Utils.getCurrentTimeAsString()+"\")) or "
					+ "(restaurant_updates.all_time = 0 and restaurant_updates.end_time >= \""+ Utils.getCurrentTimeAsString()+"\"))";

/*
			String query = "select  restaurant_updates.id as update_id,restaurants.id as rest_id, (Select group_concat(days separator ', ') "
					+ "from restaurant_updates_days where restaurant_updates_days.update_id = restaurant_updates.id group by restaurant_updates_days.update_id) "
					+ "as active_days, case when restaurants.start_time_2 is null OR restaurants.start_time_2 ='' then  restaurants.start_time else "
					+ "restaurants.start_time_2 end as rest_start_time,case when restaurants.end_time_2 is null OR restaurants.end_time_2 ='' then "
					+ "restaurants.end_time else restaurants.end_time_2 end as rest_end_time, restaurant_updates.start_time as update_start_time, "
					+ "restaurant_updates.end_time as update_end_time, restaurant_updates.all_time, restaurant_updates.updates as update_text, "
					+ "restaurant_updates.is_primary as is_primary ,restaurant_updates.start_date as update_start_date, restaurant_updates.end_date as update_end_date"
					+ " from restaurants left join restaurant_updates on restaurant_updates.restaurant_id = "
					+ "restaurants.id where restaurants.id = :restId and restaurant_updates.status = 1 and "
					+ "restaurant_updates.start_date <= \":startDate\" and restaurant_updates.end_date >= \":endDate\" and ((restaurant_updates.all_time = 1 and "
					+ "(time_format(str_to_date(restaurants.end_time, \"%h:%i %p\"), \"%H:%i:%s\")>= \":restEndTime\" or "
					+ "time_format(str_to_date(restaurants.end_time_2,\"%h:%i %p\"), \"%H:%i:%s\") >= \":restEndTime2\")) or "
					+ "(restaurant_updates.all_time = 0 and restaurant_updates.end_time >= \":updateEndTime\"))";*/
			/*NamedParameterJdbcTemplate template = new NamedParameterJdbcTemplate(
					abstractDao.getJdbcTemplate().getDataSource());
			select.query(query,
			        new UpdateBaseRestRowMapper())*/
			updateBaseList = abstractDao.getJdbcTemplate().query(query,
			        new UpdateBaseRestRowMapper());
			//updateBaseList = template.query(query, parameters, new UpdateBaseRestRowMapper());

		} catch (Exception ex) {
			logger.error("Error in  findRestrauantByLocation :" + ex.getMessage());
		}
		return updateBaseList;

	}

	/*
	 * select * from foozup_restaurant.restaurant_updates;
	 * 
	 * select case when restaurants.end_time_2 is null OR restaurants.end_time_2
	 * ='' then restaurants.end_time else restaurants.end_time_2 end as
	 * end_time,franchisee_updates.end_time as update_end_time,
	 * franchisee_updates.all_time, franchisee_updates.id as update_id,
	 * restaurants.id, franchisee_updates.updates,
	 * franchisee_updates.activation_type, franchisee_updates.start_date,
	 * franchisee_updates.end_date from restaurants left join
	 * franchisee_updates_restaurant on
	 * franchisee_updates_restaurant.restaurant_id = restaurants.id left join
	 * franchisee_updates on franchisee_updates.id =
	 * franchisee_updates_restaurant.update_id where restaurants.id = 2 and
	 * franchisee_updates.status = 1 and franchisee_updates.start_date <=
	 * "2016-06-02 00:00:00" and franchisee_updates.end_date >=
	 * "2016-06-02 00:00:00" and ( (franchisee_updates.all_time = 1 and
	 * (time_format(str_to_date(restaurants.end_time, "%h:%i %p"), "%H:%i:%s")
	 * >= "'10:00:00'" or time_format(str_to_date(restaurants.end_time_2,
	 * "%h:%i %p"), "%H:%i:%s") >= "'10:00:00'")) or
	 * (franchisee_updates.all_time = 1 and franchisee_updates.end_time >=
	 * "10:00:00"));
	 */

	/*
	 * 
	 * select (Select group_concat(days separator ', ') from
	 * restaurant_updates_days where restaurant_updates_days.update_id =
	 * restaurant_updates.id group by restaurant_updates_days.update_id) as abc,
	 * case when restaurants.end_time_2 is null OR restaurants.end_time_2 =''
	 * then restaurants.end_time else restaurants.end_time_2 end as end_time,
	 * restaurant_updates.start_time as update_start_time,
	 * restaurant_updates.end_time as update_end_time,
	 * restaurant_updates.all_time, restaurant_updates.id as update_id,
	 * restaurants.id, restaurant_updates.updates,
	 * restaurant_updates.start_date, restaurant_updates.end_date,
	 * restaurant_updates.is_primary from restaurants left join
	 * restaurant_updates on restaurant_updates.restaurant_id = restaurants.id
	 * where restaurants.id = 7 and restaurant_updates.status = 1 and
	 * restaurant_updates.start_date <= "2016-06-02 00:00:00" and
	 * restaurant_updates.end_date >= "2016-06-08 00:00:00" and
	 * ((restaurant_updates.all_time = 1 and
	 * (time_format(str_to_date(restaurants.end_time, "%h:%i %p"), "%H:%i:%s")
	 * >= "20:00:00" or time_format(str_to_date(restaurants.end_time_2,
	 * "%h:%i %p"), "%H:%i:%s") >= "20:00:00")) or (restaurant_updates.all_time
	 * = 0 and restaurant_updates.end_time >= "20:00:00"));
	 */

	/*
	 * select case when restaurants.end_time_2 is null OR restaurants.end_time_2
	 * ='' then restaurants.end_time else restaurants.end_time_2 end as
	 * end_time, restaurant_updates.start_time as update_start_time,
	 * restaurant_updates.end_time as update_end_time,
	 * restaurant_updates.all_time, restaurant_updates.id as update_id,
	 * restaurants.id, restaurant_updates.updates,
	 * restaurant_updates.activation_type, restaurant_updates.start_date,
	 * restaurant_updates.end_date, restaurant_updates.is_primary from
	 * restaurants left join restaurant_updates on
	 * restaurant_updates.restaurant_id = restaurants.id where restaurants.id =
	 * '.$restaurant_id.' and restaurant_updates.status = 1 and
	 * restaurant_updates.start_date = "'.date('Y-m-d'). ' 00:00:00" and
	 * restaurant_updates.end_date = "'.date('Y-m-d'). '" and
	 * ((restaurant_updates.all_time = 1 and
	 * (time_format(str_to_date(restaurants.end_time, "%h:%i %p"), "%H:%i:%s")
	 * >= "'.date('H:i:s').'" or time_format(str_to_date(restaurants.end_time_2,
	 * "%h:%i %p"), "%H:%i:%s") >= "'.date('H:i:s').'")) or
	 * (restaurant_updates.all_time = 0 and restaurant_updates.end_time >=
	 * "'.date('H:i:s').'"));
	 * 
	 * 
	 * 
	 * select case when restaurants.end_time_2 is null OR restaurants.end_time_2
	 * ='' then restaurants.end_time else restaurants.end_time_2 end as
	 * end_time, restaurant_updates.end_time as update_end_time,
	 * restaurant_updates.all_time, restaurant_updates.id as update_id,
	 * restaurants.id,restaurant_updates.activation_type,
	 * restaurant_updates.start_date, restaurant_updates.end_date,
	 * restaurant_updates.is_primary from restaurants left join
	 * restaurant_updates on restaurant_updates.restaurant_id = restaurants.id
	 * where restaurants.id = '.$restaurant_id.' and restaurant_updates.status =
	 * 1 and restaurant_updates.start_date <= "'.date('Y-m-d'). ' 00:00:00" and
	 * restaurant_updates.end_date >= "'.date('Y-m-d'). '" and
	 * ((restaurant_updates.all_time = 1 and
	 * (time_format(str_to_date(restaurants.end_time, "%h:%i %p"), "%H:%i:%s")
	 * >= "'.date('H:i:s').'" or time_format(str_to_date(restaurants.end_time_2,
	 * "%h:%i %p"), "%H:%i:%s") >= "'.date('H:i:s').'")) or
	 * (restaurant_updates.all_time = 0 and restaurant_updates.end_time >=
	 * "'.date('H:i:s').'")) order by restaurant_updates.updated_at desc;
	 */

}
